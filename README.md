# traffic-rule-engine_tianjin

## 项目概述
本项目是一个用于推算天津车辆限行规则的工具，基于历史限行规则数据（每90天周期轮换）推算未来任意年份或年份范围的限行规则。

## 功能介绍
- 根据历史限行规则推算未来多年的限行规则
- 支持查询指定年份或年份范围（如2022-2033）的限行规则
- 支持两种输出格式：
  - 文本格式：直观展示每日限行尾号
  - SQL语句格式：生成可直接导入数据库的SQL插入语句

## 文件结构
```
traffic-rule-engine_tianjin/
├── README.md               # 项目说明文档
├── 天津限行规则推算.py       # 核心推算逻辑，输出文本格式结果
├── 天津限行规则数据写入.py   # 基于推算结果生成SQL语句
└── 限行规则推算结果_*.txt   # 生成的限行规则文本文件（运行后生成）
```

## 使用方法

### 1. 天津限行规则推算.py
此文件用于推算限行规则并输出直观的文本格式结果。

**运行方法**：
```bash
python 天津限行规则推算.py
```

**运行流程**：
1. 程序会提示输入年份范围（如：2022-2033）
2. 程序会根据内置的基础规则推算指定年份范围的限行规则
3. 结果将保存到以时间段命名的文本文件中（如：限行规则推算结果_2022-01-01_2033-12-31.txt）

### 2. 天津限行规则数据写入.py
此文件用于基于推算结果生成SQL插入语句。

**运行方法**：
```bash
python 天津限行规则数据写入.py
```

**运行流程**：
1. 程序会提示输入年份范围（如：2023-2025）
2. 程序会根据内置的基础规则推算指定年份范围的限行规则并生成SQL语句
3. 结果将保存到以时间段命名的SQL语句文件中（如：限行规则SQL语句_2023-01-01_2025-12-31.txt）

## 核心算法说明
- 基于90天为一个周期的轮换规则
- 每个周期内的限行尾号按照固定顺序轮换
- 支持向前和向后推算多个周期的规则
- 智能处理时间段交集，确保输出的规则精确匹配用户需求的时间范围

## 输入输出示例

### 输入示例
```
请输入需要查询的年份范围（如：2022-2033）：2025-2026
```

### 输出示例（文本格式）
```
阶段：2025-01-01 至 2025-03-31
  周一: 限行尾号 5,0
  周二: 限行尾号 1,6
  周三: 限行尾号 2,7
  周四: 限行尾号 3,8
  周五: 限行尾号 4,9
  周六: 限行尾号 5,0
  周日: 限行尾号 1,6

阶段：2025-04-01 至 2025-06-30
  ...
```

### 输出示例（SQL语句格式）
```
INSERT INTO `jy_traffic_restriction_rules` (`region`, `start_date`, `end_date`, `day_of_week`, `restricted_plates`) VALUES ('天津', '2025-01-01', '2025-03-31', 1, '5,0');
INSERT INTO `jy_traffic_restriction_rules` (`region`, `start_date`, `end_date`, `day_of_week`, `restricted_plates`) VALUES ('天津', '2025-01-01', '2025-03-31', 2, '1,6');
...
```

## 注意事项
1. 程序默认使用的基础规则（rootRules）是基于历史数据设定的，请确保这些规则与实际政策一致
2. 推算结果仅供参考，实际限行规则请以官方发布为准
3. 如需修改基础推算参数（如初始日期、规则列表等），可直接编辑相应的Python文件

## 环境要求
- Python 3.x
- 无需安装额外依赖库（仅使用内置的datetime模块）

## 扩展与定制
如需根据不同城市的限行规则进行定制，可以修改以下参数：
- `rootRules`：每周的限行尾号规则
- `period_days`：规则轮换的周期天数
- `region`：地区名称（SQL语句中使用）

## 更新日志
- 添加了年份范围查询功能，支持查询多年的限行规则
- 优化了输出格式，使结果更加直观易读
- 增加了时间段筛选逻辑，精确匹配用户需求
- 统一了两个文件的输入方式和处理逻辑

## 免责声明
本工具仅用于技术研究和学习，推算结果仅供参考。实际限行规则请以当地交通管理部门官方发布为准。
